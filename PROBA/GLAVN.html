<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artemisia</title>
    <link rel="icon" href="https://i.postimg.cc/zXXhVbHv/11.png" type="image/x-icon">
    <link rel="stylesheet" href="../style.css">


</head>

<body>
    <!-- Header с поисковой строкой -->
    <header>
        <div class="header-left">
            <div class="menu-icon" id="menuIcon" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <a href="index.html"> <img src="https://i.postimg.cc/hjBzgfqS/1.png" alt="Логотип" class="logo"> </a>
        </div>

        <div class="search-container" id="searchContainer">
            <div class="search-box">
                <div class="search-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="#aaa" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" />
                    </svg>
                </div>
                <input type="text" id="searchInput" placeholder="Поиск художников..." autocomplete="off">
                <button class="search-btn" onclick="searchArtists()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="#262626" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" />
                    </svg>
                </button>
            </div>
            <div class="search-results" id="searchResults"></div>
        </div>

        <button class="mobile-search-btn" id="mobileSearchBtn" onclick="toggleSearch()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="white" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" />
            </svg>
        </button>
        <div class="search-backdrop" id="searchBackdrop" onclick="toggleSearch()"></div>
    </header>

    <!-- Menu Drawer -->
    <div class="overlay" id="overlay" onclick="toggleMenu()"></div>
    <div class="drawer" id="drawer">
        <ul class="menu">
            <li><a href="index.html">
                    <img src="https://i.postimg.cc/6p8Gfk0N/home.png" alt="Главная">
                    Главная
                </a>
            </li>

            <li>
                <a href="html/Artist.html">
                    <img src="https://i.postimg.cc/MGRMh1NP/man-14816778.png" alt="Художники">
                    Художники
                </a>
            </li>

            <li>
                <a href="html/Design.html">
                    <img src="https://i.postimg.cc/t4xNXgTY/free-icon-pen-tablet-4861056.png" alt="Художники">
                    Дизайнеры
                </a>
            </li>


            <li>
                <a href="#" class="has-submenu" onclick="toggleSubmenu(event)">
                    <img src="https://i.postimg.cc/85mFCN1L/mobile-shopping.png" alt="">
                    Услуги
                </a>

                <ul class="submenu">
                    <li>
                        <a href="html/Services.html#Commission" class="submenu-link"
                            onclick="openTabByLink('Commission')">
                            COMMISSION ART
                        </a>
                    </li>
                    <li>
                        <a href="html/Services.html#Yunchy" class="submenu-link" onclick="openTabByLink('Yunchy')">
                            YCH
                        </a>
                    </li>
                    <li>
                        <a href="html/Services.html#art" class="submenu-link" onclick="openTabByLink('art')">
                            ADOPT
                        </a>
                    </li>
                </ul>
            </li>

            <li><a href="">
                    <img src="https://i.postimg.cc/bYRbyHJ4/draw.png" alt="">
                    Комиксы
                </a>
            </li>

            <li class="separator-menu"></li>

            <li><a href="html/AboutUs.html#about-site">
                    Подробности о сайте
                </a>
            </li>

            <li><a href="html/AboutUs.html#publish-work">
                    Опубликовать работу
                </a>
            </li>

            <li><a href="html/AboutUs.html#guarantees">
                    Гаранты
                </a>
            </li>

            <li class="separator-menu"></li>

            <li>
                <a href="#" class="has-submenu" onclick="toggleSubmenu(event)">
                    <img src="https://i.postimg.cc/sDXB3kbZ/image.png" alt="">
                    Документы
                </a>
                <ul class="submenu">
                    <li><a href="html/Document.html#user-agreement" class="submenu-link">Соглашение</a></li>
                    <li><a href="html/Document.html#usage-rules" class="submenu-link">Правила использования</a></li>
                    <li><a href="html/Document.html#guaranteed-deals" class="submenu-link">Гарантийные сделки</a></li>
                </ul>
            </li>
        </ul>
    </div>

    <!-- Модальное окно для просмотра изображений с навигацией -->
    <div id="imageModal" class="image-modal">
        <span class="image-close-btn" onclick="closeImageModal()">&times;</span>
        <div class="image-modal-content">
            <div class="image-nav image-prev" onclick="navigateImage(-1)">&#10094;</div>
            <img id="expandedImg" class="image-modal-img" src="" alt="Expanded Image">
            <div class="image-nav image-next" onclick="navigateImage(1)">&#10095;</div>
            <div class="image-counter" id="imageCounter">1 / 4</div>
        </div>
    </div>
    </section>

    <!-- Популярные иллюстраторы -->
    <section class="popular-illustrators-section">
        <div class="popular-illustrators-header">
            <div class="section-header">
                <h2 class="section-title">Популярные иллюстраторы</h2>
            </div>

            <div class="illustrators-filters">
                <button class="illustrator-filter-btn active" onclick="changeIllustratorFilter('week')">Неделя</button>
                <button class="illustrator-filter-btn" onclick="changeIllustratorFilter('month')">Месяц</button>
            </div>
        </div>

        <div class="illustrators-grid" id="illustratorsGrid">

            <!-- Иллюстраторы недели (4 видимых + 4 скрытых) -->
            <div class="illustrator-card-v2 week"
                onclick="openImageModal('https://i.postimg.cc/FKr02FCR/93.jpg')">
                <div class="illustrator-badge">Топ недели</div>
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/FKr02FCR/93.jpg" alt="Художник 6"
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="html/Artist.html#193" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/bN0K8Xdh/32.jpg"
                                class="illustrator-avatar" alt="Ава">
                        </a>
                        madison
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            32
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 week "
                onclick="openImageModal('https://i.postimg.cc/y8rGdy32/photo-5213402098010553308-y.jpg')">
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/y8rGdy32/photo-5213402098010553308-y.jpg" alt="Художник 9"
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="html/Artist.html#203" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/yY9wmxjM/52.jpg" class="illustrator-avatar" alt="Ава">
                        </a>
                        хидзума
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            26
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 week hidden-illustrators"
                onclick="openImageModal('https://i.postimg.cc/T2zgRLPQ/photo-5212922053810845046-y.jpg')">
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/T2zgRLPQ/photo-5212922053810845046-y.jpg" alt=""
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="html/Artist.html#" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/T2zgRLPQ/photo-5212922053810845046-y.jpg" class="illustrator-avatar" alt="Ава">
                        </a>
                        @MirisVillsonArt
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            24
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 week hidden-illustrators"
                onclick="openImageModal('https://i.postimg.cc/2SP1yfJQ/photo-5212922053810845075-y.jpg')">
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/2SP1yfJQ/photo-5212922053810845075-y.jpg" alt=""
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="Prem/creppylandau.html" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/gjHY8YW3/photo-2025-05-08-18-39-32.jpg"
                                class="illustrator-avatar" alt="Ава">
                        </a>
                        creppylandau
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            20
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 week hidden-illustrators"
                onclick="openImageModal('https://i.postimg.cc/90v6TJjn/photo-5213046122531123552-y.jpg')">
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/90v6TJjn/photo-5213046122531123552-y.jpg" alt=""
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="html/Artist.html#" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/90v6TJjn/photo-5213046122531123552-y.jpg"
                                class="illustrator-avatar" alt="Ава">
                        </a>
                        @waifu_for_hour
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            18
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 week hidden-illustrators"
                onclick="openImageModal('https://i.postimg.cc/WpCLQbJw/photo-5211167800188601426-y.jpg')">
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/WpCLQbJw/photo-5211167800188601426-y.jpg" alt=""
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="html/Artist.html#" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/WpCLQbJw/photo-5211167800188601426-y.jpg"
                                class="illustrator-avatar" alt="Ава">
                        </a>
                        @alart1716
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            18
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>
            

            <!-- Иллюстраторы месяца (4 видимых + 4 скрытых) -->
            <div class="illustrator-card-v2 month" onclick="openImageModal('https://i.postimg.cc/qM2qQ5Xf/1.jpg')">

                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/qM2qQ5Xf/1.jpg" alt="Художник 6" class="illustrator-image">
                </div>

                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="html/Artist.html#177" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/htrjRQ5p/4.jpg" class="illustrator-avatar" alt="Ава">
                        </a>
                        Printer
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            19
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 month"
                onclick="openImageModal('https://i.postimg.cc/2jPgptm3/photo-5438235050316526562-y.jpg')">

                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/2jPgptm3/photo-5438235050316526562-y.jpg" alt="Художник 6"
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="Prem/roklimorii.html" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/qM8QzqWq/photo-5244899575683215394-y.jpg"
                                class="illustrator-avatar" alt="Ава">
                        </a>
                        roklimorii
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            27
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 month hidden-illustrators"
                onclick="openImageModal('https://i.postimg.cc/kG1PZxhk/photo-5460950011358605594-y.jpg')">
                
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/kG1PZxhk/photo-5460950011358605594-y.jpg" alt="Художник 6"
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="Prem/creppylandau.html" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/gjHY8YW3/photo-2025-05-08-18-39-32.jpg"
                                class="illustrator-avatar" alt="Ава">
                        </a>
                        creppylandau
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            31
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 month hidden-illustrators"
                onclick="openImageModal('https://i.postimg.cc/dtCczpQT/photo-5195252816053141390-y.jpg')">
                <div class="illustrator-badge">Топ месяца</div>
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/dtCczpQT/photo-5195252816053141390-y.jpg" alt="Художник 6"
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="html/Artist.html#201" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/SRQ9GbF6/6.jpg"
                                class="illustrator-avatar" alt="Ава">
                        </a>
                        Сендли
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            34
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>

            <div class="illustrator-card-v2 month hidden-illustrators"
                onclick="openImageModal('https://i.postimg.cc/FKr02FCR/93.jpg')">
                
                <div class="illustrator-image-container">
                    <img src="https://i.postimg.cc/FKr02FCR/93.jpg" alt="Художник 6"
                        class="illustrator-image">
                </div>
                <div class="illustrator-info">
                    <h3 class="illustrator-name">
                        <a href="html/Artist.html#193" onclick="event.stopPropagation()">
                            <img src="https://i.postimg.cc/bN0K8Xdh/32.jpg"
                                class="illustrator-avatar" alt="Ава">
                        </a>
                        madison
                    </h3>
                    <p class="illustrator-style"></p>
                    <p class="illustrator-style"></p>
                    <div class="illustrator-stats">
                        <div class="illustrator-likes">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                            32
                        </div>
                        <div class="illustrator-price"></div>
                    </div>
                </div>
            </div>




        </div>

        <button class="view-all-btn" id="viewAllBtn">Смотреть всех</button>
    </section>

    <!-- Image Modal -->
    <div id="imageModal" class="image-modal">
        <span class="image-close-btn" onclick="closeImageModal()">&times;</span>
        <div class="image-modal-content">
            <img id="expandedImg" class="image-modal-img" src="" alt="Expanded Image">
        </div>
    </div>

    <script>
        // Menu Functions
        function toggleMenu() {
            const drawer = document.getElementById('drawer');
            const overlay = document.getElementById('overlay');
            const menuIcon = document.getElementById('menuIcon');
            const body = document.body;
            const searchInput = document.getElementById('searchInput');

            // Сохраняем позицию прокрутки перед открытием
            if (!body.classList.contains('menu-open')) {
                body.style.top = `-${window.scrollY}px`;
            }

            drawer.classList.toggle('open');
            overlay.classList.toggle('active');
            menuIcon.classList.toggle('active');
            body.classList.toggle('menu-open');
            searchInput.disabled = body.classList.contains('menu-open');

            // Восстанавливаем позицию прокрутки при закрытии
            if (!body.classList.contains('menu-open')) {
                const scrollY = parseInt(body.style.top || '0');
                body.style.top = '';
                window.scrollTo(0, -scrollY);
            }
        }

        function closeMenu() {
            const drawer = document.getElementById('drawer');
            const overlay = document.getElementById('overlay');
            const menuIcon = document.getElementById('menuIcon');
            const body = document.body;

            drawer.classList.remove('open');
            overlay.classList.remove('active');
            menuIcon.classList.remove('active');
            body.classList.remove('menu-open');
        }

        // Toggle submenus
        function toggleSubmenu(event) {
            event.preventDefault();
            const link = event.currentTarget;
            const submenu = link.nextElementSibling;

            // Close all other submenus first
            document.querySelectorAll('.submenu').forEach(menu => {
                if (menu !== submenu) {
                    menu.classList.remove('active');
                    menu.previousElementSibling.classList.remove('active');
                }
            });

            // Toggle current submenu
            link.classList.toggle('active');
            submenu.classList.toggle('active');
        }

        // Close menu when clicking on overlay
        document.getElementById('overlay').addEventListener('click', closeMenu);

        // New Search Functionality
        function toggleSearch() {
            const searchContainer = document.getElementById('searchContainer');
            const searchBackdrop = document.getElementById('searchBackdrop');
            const isActive = searchContainer.classList.contains('active');

            if (isActive) {
                searchContainer.classList.remove('active');
                searchBackdrop.classList.remove('active');
                document.getElementById('searchResults').classList.remove('active');
                document.getElementById('searchInput').value = '';
                document.body.style.overflow = 'auto';
            } else {
                searchContainer.classList.add('active');
                searchBackdrop.classList.add('active');
                document.getElementById('searchInput').focus();
                document.body.style.overflow = 'hidden';
            }

            // Close menu if open
            if (document.getElementById('drawer').classList.contains('open')) {
                toggleMenu();
            }
        }

        function searchArtists() {
            const searchText = document.getElementById('searchInput').value.trim().toLowerCase();
            const resultsContainer = document.getElementById('searchResults');

            if (!searchText) {
                resultsContainer.innerHTML = '<div class="no-results">Введите запрос для поиска</div>';
                resultsContainer.classList.add('active');
                return;
            }

            const artists = document.querySelectorAll('.profile-section');
            let found = false;
            resultsContainer.innerHTML = '';

            artists.forEach(artist => {
                const artistName = artist.querySelector('h1').textContent.toLowerCase();
                const artistStyle = artist.querySelector('p').textContent.toLowerCase();
                const artistLink = artist.querySelector('.profile-link').textContent.toLowerCase();
                const artistAvatar = artist.querySelector('.avatar').src;

                if (artistName.includes(searchText) || artistStyle.includes(searchText) || artistLink.includes(searchText)) {
                    found = true;
                    const resultItem = document.createElement('div');
                    resultItem.className = 'search-result-item';

                    resultItem.innerHTML = `
                    <img src="${artistAvatar}" alt="${artistName}">
                    <div class="info">
                        <div class="name">${artist.querySelector('h1').textContent}</div>
                        <div class="style">${artist.querySelector('p').textContent}</div>
                    </div>
                `;

                    resultItem.onclick = () => {
                        document.getElementById('searchInput').value = '';
                        scrollToArtist(artist);
                        toggleSearch();
                    };
                    resultsContainer.appendChild(resultItem);
                }
            });

            if (!found) {
                resultsContainer.innerHTML = '<div class="no-results">Поиск доступен на странице с Художниками </div>';
            }
            resultsContainer.classList.add('active');
        }

        // Highlight text
        function highlightText(element, searchText) {
            const text = element.textContent;
            const regex = new RegExp(`(${searchText})`, 'gi');
            element.innerHTML = text.replace(regex, match =>
                `<span class="highlight">${match}</span>`
            );
        }

        // Обновленная функция прокрутки к художнику
        function scrollToArtist(artist) {
            // Удаляем предыдущие подсветки
            document.querySelectorAll('.artist-highlight').forEach(el => {
                el.classList.remove('artist-highlight');
            });

            // Добавляем подсветку
            artist.classList.add('artist-highlight');

            // Прокручиваем плавно к элементу с учетом хедера
            const yOffset = -80;
            const y = artist.getBoundingClientRect().top + window.pageYOffset + yOffset;

            window.scrollTo({
                top: y,
                behavior: 'smooth'
            });

            // Убираем подсветку через 3 секунды
            setTimeout(() => {
                artist.classList.remove('artist-highlight');
            }, 3000);

            // Упрощенная обработка прерывания прокрутки
            const handleInterrupt = () => {
                artist.classList.remove('artist-highlight');
            };

            // Добавляем однократный обработчик
            window.addEventListener('scroll', handleInterrupt, {
                once: true,
                passive: true // Оптимизация для плавной прокрутки
            });

            // Гарантируем восстановление скролла
            setTimeout(() => {
                document.body.style.overflow = 'auto';
                document.body.style.position = 'static';
            }, 500);
        }

        // Search on Enter key
        document.getElementById('searchInput').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                searchArtists();
            }
        });

        // Real-time search on input
        document.getElementById('searchInput').addEventListener('input', function () {
            if (this.value.length > 0) {
                searchArtists();
            } else {
                document.getElementById('searchResults').classList.remove('active');
            }
        });

        // Close search when clicking outside (desktop)
        document.addEventListener('click', function (e) {
            const searchContainer = document.getElementById('searchContainer');
            const searchResults = document.getElementById('searchResults');
            const searchInput = document.getElementById('searchInput');
            const mobileSearchBtn = document.getElementById('mobileSearchBtn');

            if (!searchContainer.contains(e.target) &&
                e.target !== mobileSearchBtn &&
                !searchResults.contains(e.target)) {
                searchResults.classList.remove('active');
            }
        });

        // Close search when scrolling on mobile
        window.addEventListener('scroll', function () {
            if (window.innerWidth <= 768 &&
                document.getElementById('searchContainer').classList.contains('active')) {
                toggleSearch();
            }
        });

        // Carousel Functionality
        const carouselStates = {};
        const autoScrollIntervals = {};

        // Проверка, виден ли последний элемент
        function isLastItemVisible(worksInnerId) {
            const worksInner = document.getElementById(worksInnerId);
            const container = worksInner.parentElement;
            const lastItem = worksInner.lastElementChild;

            if (!lastItem) return true;

            const containerRect = container.getBoundingClientRect();
            const lastItemRect = lastItem.getBoundingClientRect();

            // Проверяем, виден ли последний элемент (с небольшим запасом)
            return lastItemRect.right <= containerRect.right + 5;
        }

        // Initialize carousels when DOM is loaded
        document.addEventListener('DOMContentLoaded', function () {
            initCarousel('newPublicationsWorks');
            initCarousel('popularArtistsWorks');

            // Start auto-scrolling for both carousels
            startAutoScroll('newPublicationsWorks');
            startAutoScroll('popularArtistsWorks');

            // Adapt carousels on window resize
            window.addEventListener('resize', () => {
                Object.keys(carouselStates).forEach(worksInnerId => {
                    carouselStates[worksInnerId].currentTranslate = 0;
                    setPosition(worksInnerId);
                });
            });
        });

        // Function to start auto-scrolling
        function startAutoScroll(worksInnerId) {
            // Clear any existing interval for this carousel
            if (autoScrollIntervals[worksInnerId]) {
                clearInterval(autoScrollIntervals[worksInnerId]);
            }

            // Set new interval
            autoScrollIntervals[worksInnerId] = setInterval(() => {
                const state = carouselStates[worksInnerId];
                const worksInner = document.getElementById(worksInnerId);
                const isArtistCarousel = worksInner.classList.contains('artists-inner');
                const items = worksInner.querySelectorAll(isArtistCarousel ? '.artist-card' : '.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3');

                if (items.length === 0) return;

                const itemWidth = isArtistCarousel ? items[0].offsetWidth + 30 : items[0].offsetWidth + 20;
                const visibleItems = getVisibleItemsCount(worksInnerId);
                const maxTranslate = -(items.length - visibleItems) * itemWidth;

                // If we're at the end, reset to start
                if (state.currentTranslate <= maxTranslate) {
                    state.currentIndex = 0;
                    state.currentTranslate = 0;
                    worksInner.style.transition = 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                    worksInner.style.transform = `translateX(${state.currentTranslate}px)`;
                } else {
                    // Otherwise, scroll to next item
                    nextWork(worksInnerId, 1);
                }
            }, 3000); // Change slide every 5 seconds
        }

        // Pause auto-scroll on hover
        function setupAutoScrollPause(worksInnerId) {
            const worksInner = document.getElementById(worksInnerId);
            const carousel = worksInner.parentElement;

            carousel.addEventListener('mouseenter', () => {
                if (autoScrollIntervals[worksInnerId]) {
                    clearInterval(autoScrollIntervals[worksInnerId]);
                }
            });

            carousel.addEventListener('mouseleave', () => {
                startAutoScroll(worksInnerId);
            });
        }

        function initCarousel(worksInnerId) {
            if (!carouselStates[worksInnerId]) {
                carouselStates[worksInnerId] = {
                    currentTranslate: 0,
                    prevTranslate: 0,
                    isDragging: false,
                    startPos: 0,
                    animationID: 0,
                    currentIndex: 0,
                    velocity: 0,
                    lastTime: 0,
                    lastPos: 0
                };
            }

            const worksInner = document.getElementById(worksInnerId);
            const isArtistCarousel = worksInner.classList.contains('artists-inner');
            const items = worksInner.querySelectorAll(isArtistCarousel ? '.artist-card' : '.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3');

            // Добавляем transition для плавности
            worksInner.style.transition = 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';

            // Setup auto-scroll pause on hover
            setupAutoScrollPause(worksInnerId);

            // Touch events для мобильных устройств
            worksInner.addEventListener('touchstart', (e) => {
                const state = carouselStates[worksInnerId];
                state.isDragging = true;
                state.startPos = e.touches[0].clientX;
                state.prevTranslate = state.currentTranslate;
                state.lastPos = state.startPos;
                state.lastTime = performance.now();
                state.velocity = 0;

                // Отключаем transition во время драга
                worksInner.style.transition = 'none';
                cancelAnimationFrame(state.animationID);

                // Pause auto-scroll during interaction
                if (autoScrollIntervals[worksInnerId]) {
                    clearInterval(autoScrollIntervals[worksInnerId]);
                }
            });

            worksInner.addEventListener('touchmove', (e) => {
                const state = carouselStates[worksInnerId];
                if (!state.isDragging) return;

                const currentPos = e.touches[0].clientX;
                const currentTime = performance.now();
                const deltaTime = currentTime - state.lastTime;

                if (deltaTime > 0) {
                    state.velocity = (currentPos - state.lastPos) / deltaTime;
                    state.lastPos = currentPos;
                    state.lastTime = currentTime;
                }

                state.currentTranslate = state.prevTranslate + currentPos - state.startPos;

                // Ограничиваем движение границами
                const maxTranslate = 0;
                const minTranslate = -getMaxTranslate(worksInnerId);
                state.currentTranslate = Math.max(minTranslate, Math.min(maxTranslate, state.currentTranslate));

                state.animationID = requestAnimationFrame(() => {
                    worksInner.style.transform = `translateX(${state.currentTranslate}px)`;
                });
            });

            worksInner.addEventListener('touchend', () => {
                const state = carouselStates[worksInnerId];
                if (!state.isDragging) return;
                state.isDragging = false;
                cancelAnimationFrame(state.animationID);

                // Включаем transition для плавного завершения
                worksInner.style.transition = 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';

                // Применяем инерцию, если скорость достаточно высока
                if (Math.abs(state.velocity) > 0.2) {
                    const direction = state.velocity > 0 ? -1 : 1;
                    const distance = Math.min(200, Math.abs(state.velocity * 200));

                    state.currentTranslate += distance * direction;

                    // Ограничиваем движение границами
                    const maxTranslate = 0;
                    const minTranslate = -getMaxTranslate(worksInnerId);
                    state.currentTranslate = Math.max(minTranslate, Math.min(maxTranslate, state.currentTranslate));
                }

                // Корректируем позицию после инерции
                snapToNearestItem(worksInnerId);

                // Resume auto-scroll after interaction
                startAutoScroll(worksInnerId);
            });

            // Mouse events для десктопа
            worksInner.addEventListener('mousedown', (e) => {
                const state = carouselStates[worksInnerId];
                state.isDragging = true;
                state.startPos = e.clientX;
                state.prevTranslate = state.currentTranslate;
                state.lastPos = state.startPos;
                state.lastTime = performance.now();
                state.velocity = 0;

                worksInner.style.transition = 'none';
                cancelAnimationFrame(state.animationID);
                e.preventDefault();

                // Pause auto-scroll during interaction
                if (autoScrollIntervals[worksInnerId]) {
                    clearInterval(autoScrollIntervals[worksInnerId]);
                }
            });

            document.addEventListener('mousemove', (e) => {
                const state = carouselStates[worksInnerId];
                if (!state.isDragging) return;

                const currentPos = e.clientX;
                const currentTime = performance.now();
                const deltaTime = currentTime - state.lastTime;

                if (deltaTime > 0) {
                    state.velocity = (currentPos - state.lastPos) / deltaTime;
                    state.lastPos = currentPos;
                    state.lastTime = currentTime;
                }

                state.currentTranslate = state.prevTranslate + currentPos - state.startPos;

                const maxTranslate = 0;
                const minTranslate = -getMaxTranslate(worksInnerId);
                state.currentTranslate = Math.max(minTranslate, Math.min(maxTranslate, state.currentTranslate));

                state.animationID = requestAnimationFrame(() => {
                    worksInner.style.transform = `translateX(${state.currentTranslate}px)`;
                });
            });

            document.addEventListener('mouseup', () => {
                const state = carouselStates[worksInnerId];
                if (!state.isDragging) return;
                state.isDragging = false;
                cancelAnimationFrame(state.animationID);

                worksInner.style.transition = 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';

                if (Math.abs(state.velocity) > 0.2) {
                    const direction = state.velocity > 0 ? -1 : 1;
                    const distance = Math.min(200, Math.abs(state.velocity * 200));

                    state.currentTranslate += distance * direction;

                    const maxTranslate = 0;
                    const minTranslate = -getMaxTranslate(worksInnerId);
                    state.currentTranslate = Math.max(minTranslate, Math.min(maxTranslate, state.currentTranslate));
                }

                snapToNearestItem(worksInnerId);

                // Resume auto-scroll after interaction
                startAutoScroll(worksInnerId);
            });

            // Функция для привязки к ближайшему элементу
            function snapToNearestItem(worksInnerId) {
                const state = carouselStates[worksInnerId];
                const worksInner = document.getElementById(worksInnerId);
                const isArtistCarousel = worksInner.classList.contains('artists-inner');
                const items = worksInner.querySelectorAll(isArtistCarousel ? '.artist-card' : '.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3');

                if (items.length === 0) return;

                const itemWidth = isArtistCarousel ? items[0].offsetWidth + 30 : items[0].offsetWidth + 20;
                const newIndex = Math.round(-state.currentTranslate / itemWidth);
                const maxIndex = items.length - getVisibleItemsCount(worksInnerId);

                state.currentIndex = Math.max(0, Math.min(maxIndex, newIndex));
                state.currentTranslate = -state.currentIndex * itemWidth;

                worksInner.style.transform = `translateX(${state.currentTranslate}px)`;
                updateCarouselControls(worksInnerId);
            }
        }

        // Функция для обновления состояния кнопок управления
        function updateCarouselControls(worksInnerId) {
            const state = carouselStates[worksInnerId];
            const carousel = document.getElementById(worksInnerId).parentElement;
            const nextBtn = carousel.querySelector('.next');
            const prevBtn = carousel.querySelector('.prev');

            if (!nextBtn || !prevBtn) return;

            // Проверяем, достигли ли мы конца
            const isEnd = isLastItemVisible(worksInnerId);

            nextBtn.disabled = isEnd;
            prevBtn.disabled = state.currentIndex === 0;

            nextBtn.style.opacity = isEnd ? '0.5' : '1';
            prevBtn.style.opacity = state.currentIndex === 0 ? '0.5' : '1';
        }

        // Функция для получения максимального смещения
        function getMaxTranslate(worksInnerId) {
            const worksInner = document.getElementById(worksInnerId);
            const isArtistCarousel = worksInner.classList.contains('artists-inner');
            const items = worksInner.querySelectorAll(isArtistCarousel ? '.artist-card' : '.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3');

            if (items.length === 0) return 0;

            if (isArtistCarousel) {
                const cardWidth = items[0].offsetWidth + 30; // Work width + gap
                return (items.length - 1) * cardWidth;
            } else {
                const workWidth = items[0].offsetWidth + 20; // Work width + gap
                return (items.length - 1) * workWidth;
            }
        }

        function getVisibleItemsCount(worksInnerId) {
            const worksInner = document.getElementById(worksInnerId);
            const isArtistCarousel = worksInner.classList.contains('artists-inner');
            const items = worksInner.querySelectorAll(isArtistCarousel ? '.artist-card' : '.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3');
            const containerWidth = worksInner.parentElement.offsetWidth;

            if (items.length === 0) return 1;

            if (isArtistCarousel) {
                const cardWidth = items[0].offsetWidth + 30; // Work width + gap
                return Math.floor(containerWidth / cardWidth);
            } else {
                const workWidth = items[0].offsetWidth + 20; // Work width + gap
                return Math.floor(containerWidth / workWidth);
            }
        }

        function animation(worksInnerId) {
            setPosition(worksInnerId);
            const state = carouselStates[worksInnerId];
            if (state.isDragging) requestAnimationFrame(() => animation(worksInnerId));
        }

        function setPosition(worksInnerId) {
            const state = carouselStates[worksInnerId];
            const worksInner = document.getElementById(worksInnerId);

            // Используем requestAnimationFrame для плавности
            requestAnimationFrame(() => {
                worksInner.style.transform = `translateX(${state.currentTranslate}px)`;
            });
        }

        function getVisibleWorksCount(worksInnerId) {
            const worksInner = document.getElementById(worksInnerId);
            const works = worksInner.querySelectorAll('.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3, .artist-card');
            const containerWidth = worksInner.parentElement.offsetWidth;

            if (works[0] && works[0].classList.contains('artist-card')) {
                const cardWidth = works[0].offsetWidth + 30; // Work width + gap
                return Math.floor(containerWidth / cardWidth);
            }

            const workWidth = works[0].offsetWidth + 20; // Work width + gap
            return Math.floor(containerWidth / workWidth);
        }

        function nextWork(worksInnerId, step = 1) {
            const worksInner = document.getElementById(worksInnerId);
            const isArtistCarousel = worksInner.classList.contains('artists-inner');
            const items = worksInner.querySelectorAll(isArtistCarousel ? '.artist-card' : '.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3');
            const state = carouselStates[worksInnerId];

            if (items.length === 0) return;

            const itemWidth = isArtistCarousel ? items[0].offsetWidth + 30 : items[0].offsetWidth + 20;
            const visibleItems = getVisibleItemsCount(worksInnerId);
            const maxTranslate = -(items.length - visibleItems) * itemWidth;

            if (state.currentTranslate <= maxTranslate) return;

            state.currentIndex = Math.min(state.currentIndex + step, items.length - visibleItems);
            state.currentTranslate = -state.currentIndex * itemWidth;

            worksInner.style.transition = 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
            worksInner.style.transform = `translateX(${state.currentTranslate}px)`;

            // Обновляем состояние кнопок после завершения анимации
            setTimeout(() => {
                updateCarouselControls(worksInnerId);
            }, 500);
        }

        function prevWork(worksInnerId, step = 1) {
            const worksInner = document.getElementById(worksInnerId);
            const isArtistCarousel = worksInner.classList.contains('artists-inner');
            const items = worksInner.querySelectorAll(isArtistCarousel ? '.artist-card' : '.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3');
            const state = carouselStates[worksInnerId];

            if (items.length === 0 || state.currentIndex === 0) return;

            const itemWidth = isArtistCarousel ? items[0].offsetWidth + 30 : items[0].offsetWidth + 20;

            state.currentIndex = Math.max(state.currentIndex - step, 0);
            state.currentTranslate = -state.currentIndex * itemWidth;

            worksInner.style.transition = 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
            worksInner.style.transform = `translateX(${state.currentTranslate}px)`;

            setTimeout(() => {
                updateCarouselControls(worksInnerId);
            }, 500);
        }

        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Full Image Modal Functions
        function openImageModal(imgSrc) {
            const imageModal = document.getElementById('imageModal');
            const expandedImg = document.getElementById('expandedImg');

            expandedImg.src = imgSrc;
            imageModal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeImageModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modals when clicking outside
        window.onclick = function (event) {
            document.querySelectorAll('.modal').forEach(modal => {
                if (event.target == modal) {
                    closeModal(modal.id);
                }
            });

            if (event.target === document.getElementById('imageModal')) {
                closeImageModal();
            }
        }

        // Close modals with ESC key
        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    if (modal.style.display === 'block') {
                        closeModal(modal.id);
                    }
                });

                if (document.getElementById('imageModal').style.display === 'block') {
                    closeImageModal();
                }
            }
        });

        // Click on works in carousel opens corresponding modal
        document.querySelectorAll('.work-thumb, .work-thumb-1, .work-thumb-2, .work-thumb-3').forEach(thumb => {
            thumb.addEventListener('click', function (e) {
                e.stopPropagation();
                openImageModal(this.src);
            });
        });

        // Click on images in artist modals
        document.querySelectorAll('.modal-img').forEach(img => {
            img.addEventListener('click', function (e) {
                e.stopPropagation();
                openImageModal(this.src);
            });
        });

        // Back to Top Function
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Show/hide back to top button on scroll
        window.addEventListener('scroll', function () {
            const backToTopBtn = document.getElementById('backToTopBtn');
            const backToBottomBtn = document.getElementById('backToBottomBtn');
            const scrollPosition = window.pageYOffset;
            const windowHeight = window.innerHeight;
            const documentHeight = document.body.scrollHeight;

            // Определяем, находится ли пользователь внизу страницы
            const isAtBottom = scrollPosition + windowHeight >= documentHeight - 100;

            // Управление кнопкой "Вверх"
            if (scrollPosition > 300 && !isAtBottom) {
                backToTopBtn.classList.add('active');
                backToBottomBtn.classList.add('with-up');
            } else {
                backToTopBtn.classList.remove('active');
                backToBottomBtn.classList.remove('with-up');
            }

            // Управление кнопкой "Вниз"
            if (!isAtBottom) {
                backToBottomBtn.classList.add('active');
            } else {
                backToBottomBtn.classList.remove('active');
            }
        });

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize carousels
            initCarousel('newPublicationsWorks');
            initCarousel('popularArtistsWorks');

            // Start auto-scrolling for both carousels
            startAutoScroll('newPublicationsWorks');
            startAutoScroll('popularArtistsWorks');

            // Adapt carousels on window resize
            window.addEventListener('resize', () => {
                Object.keys(carouselStates).forEach(worksInnerId => {
                    carouselStates[worksInnerId].currentTranslate = 0;
                    setPosition(worksInnerId);
                });
            });

            // Add intersection observer for animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');

                        // Для модальных изображений
                        if (entry.target.classList.contains('modal-img')) {
                            setTimeout(() => {
                                entry.target.classList.add('visible');
                            }, 100 * index);
                        }
                    }
                });
            }, observerOptions);

            // Наблюдаем за всеми элементами
            document.querySelectorAll('.new-publications, .popular-artists, .works-carousel, .profile-section').forEach(el => {
                observer.observe(el);
            });

            // Для изображений в модалках
            document.querySelectorAll('.modal-img').forEach((img, index) => {
                observer.observe(img);
            });

            // Инициализация фильтрации иллюстраторов
            filterIllustrators('week');
        });

        // Function to open tab by link
        function openTabByLink(tabId) {
            // This function would be implemented in the Services.html page
            console.log('Opening tab:', tabId);
        }

        // Function to change illustrator filter
        function changeIllustratorFilter(filterType) {
            const buttons = document.querySelectorAll('.illustrator-filter-btn');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Активируем нажатую кнопку
            event.target.classList.add('active');

            filterIllustrators(filterType);

            // Сбрасываем кнопку "Смотреть всех" при смене фильтра
            document.getElementById('viewAllBtn').textContent = 'Смотреть всех';
        }

        function filterIllustrators(filterType) {
            const illustrators = document.querySelectorAll('.illustrator-card-v2');
            const hiddenIllustrators = document.querySelectorAll('.hidden-illustrators');

            // Сначала скрываем все работы
            illustrators.forEach(illustrator => {
                illustrator.style.display = 'none';
            });

            // Показываем только работы выбранного периода
            const filteredIllustrators = document.querySelectorAll(`.illustrator-card-v2.${filterType}`);
            filteredIllustrators.forEach((illustrator, index) => {
                // Показываем первые 4 работы, остальные скрываем
                if (index < 4) {
                    illustrator.style.display = 'block';
                } else {
                    illustrator.style.display = 'none';
                }
            });

            // Скрываем все дополнительные работы
            hiddenIllustrators.forEach(illustrator => {
                illustrator.style.display = 'none';
            });
        }

        // Function to toggle view all illustrators
        document.getElementById('viewAllBtn').addEventListener('click', function () {
            const btn = document.getElementById('viewAllBtn');
            const activeFilter = document.querySelector('.illustrator-filter-btn.active').textContent;
            let filterType = 'week';

            if (activeFilter === 'Неделя') filterType = 'week';
            else if (activeFilter === 'Месяц') filterType = 'month';

            const hiddenIllustrators = document.querySelectorAll(`.illustrator-card-v2.${filterType}.hidden-illustrators`);

            if (btn.textContent === 'Смотреть всех') {
                // Показываем скрытые работы текущего фильтра
                hiddenIllustrators.forEach(illustrator => {
                    illustrator.style.display = 'block';
                });
                btn.textContent = 'Скрыть';

                // Прокручиваем к кнопке после раскрытия
                setTimeout(() => {
                    btn.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            } else {
                // Скрываем дополнительные работы текущего фильтра
                hiddenIllustrators.forEach(illustrator => {
                    illustrator.style.display = 'none';
                });
                btn.textContent = 'Смотреть всех';

                // Прокручиваем к началу секции
                document.querySelector('.popular-illustrators-section').scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });

        // Инициализация фильтрации иллюстраторов - по умолчанию "неделя"
        filterIllustrators('week');
        // Активируем кнопку "неделя"
        document.querySelector('.illustrator-filter-btn').classList.add('active');

        // Добавьте эти функции в ваш JavaScript
        function scrollToBottom() {
            const footer = document.querySelector('.site-footer');
            footer.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }

        // Инициализация карусели при загрузке страницы
        document.addEventListener('DOMContentLoaded', function () {
            initCarousel('newPublicationsWorks');
            updateCarouselControls('newPublicationsWorks');
        });
    </script>

    <script>
        // Глобальные переменные для управления галереей изображений
        let currentImageIndex = 0;
        let imageGallery = [];
        let currentGalleryType = ''; // 'new-publications' или 'popular-illustrators'
        let currentFilter = 'week'; // 'week' или 'month'
        let touchStartX = 0;
        let touchEndX = 0;

        // Модифицированная функция открытия изображения
        function openImageModal(imgSrc, galleryType = 'new-publications', filterType = 'week') {
            const imageModal = document.getElementById('imageModal');
            const expandedImg = document.getElementById('expandedImg');

            // Сохраняем тип галереи и фильтр
            currentGalleryType = galleryType;
            currentFilter = filterType;

            // Собираем все изображения в галерею в зависимости от типа и фильтра
            if (galleryType === 'new-publications') {
                // Для новых публикаций - только изображения работ (исключаем аватарки)
                imageGallery = Array.from(document.querySelectorAll('#newPublicationsWorks .work-container img')).filter(img =>
                    !img.classList.contains('work-author-avatar')
                );
            } else {
                // Для популярных иллюстраторов с учетом фильтра - только изображения работ
                imageGallery = Array.from(document.querySelectorAll(`.illustrator-card-v2.${filterType} .illustrator-image`));
            }

            // Находим индекс текущего изображения
            currentImageIndex = imageGallery.findIndex(img => img.src === imgSrc);

            // Обновляем счетчик
            updateImageCounter();

            expandedImg.src = imgSrc;
            imageModal.style.display = 'block';
            document.body.style.overflow = 'hidden';

            // Добавляем обработчики для свайпов
            imageModal.addEventListener('touchstart', handleTouchStart, false);
            imageModal.addEventListener('touchend', handleTouchEnd, false);
        }

        // Остальные функции остаются без изменений
        function closeImageModal() {
            document.getElementById('imageModal').style.display = 'none';
            document.body.style.overflow = 'auto';

            const imageModal = document.getElementById('imageModal');
            imageModal.removeEventListener('touchstart', handleTouchStart, false);
            imageModal.removeEventListener('touchend', handleTouchEnd, false);
        }

        function navigateImage(direction) {
            if (imageGallery.length === 0) return;

            currentImageIndex += direction;

            if (currentImageIndex >= imageGallery.length) {
                currentImageIndex = 0;
            } else if (currentImageIndex < 0) {
                currentImageIndex = imageGallery.length - 1;
            }

            const expandedImg = document.getElementById('expandedImg');
            expandedImg.src = imageGallery[currentImageIndex].src;
            updateImageCounter();

            expandedImg.style.opacity = '0';
            setTimeout(() => {
                expandedImg.style.opacity = '1';
            }, 50);
        }

        function updateImageCounter() {
            const counter = document.getElementById('imageCounter');
            if (counter && imageGallery.length > 0) {
                counter.textContent = `${currentImageIndex + 1} / ${imageGallery.length}`;
            }
        }

        function handleTouchStart(e) {
            touchStartX = e.changedTouches[0].screenX;
        }

        function handleTouchEnd(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }

        function handleSwipe() {
            const threshold = 50;

            if (touchEndX < touchStartX - threshold) {
                navigateImage(1);
            } else if (touchEndX > touchStartX + threshold) {
                navigateImage(-1);
            }
        }

        // Модифицируем обработчики кликов по изображениям
        document.addEventListener('DOMContentLoaded', function () {
            // Для новых публикаций - только изображения работ (исключаем аватарки)
            document.querySelectorAll('#newPublicationsWorks .work-container img:not(.work-author-avatar)').forEach((thumb, index) => {
                thumb.addEventListener('click', function (e) {
                    // Дополнительная проверка, чтобы клик по автору не открывал модальное окно
                    if (e.target.closest('.work-author')) {
                        return;
                    }
                    e.stopPropagation();
                    openImageModal(this.src, 'new-publications');
                });
            });

            // Для популярных иллюстраторов (неделя)
            document.querySelectorAll('.illustrator-card-v2.week .illustrator-image').forEach((thumb, index) => {
                thumb.addEventListener('click', function (e) {
                    e.stopPropagation();
                    openImageModal(this.src, 'popular-illustrators', 'week');
                });
            });

            // Для популярных иллюстраторов (месяц)
            document.querySelectorAll('.illustrator-card-v2.month .illustrator-image').forEach((thumb, index) => {
                thumb.addEventListener('click', function (e) {
                    e.stopPropagation();
                    openImageModal(this.src, 'popular-illustrators', 'month');
                });
            });
        });

        // Обработчики клавиш для навигации по изображениям
        document.addEventListener('keydown', function (e) {
            const imageModal = document.getElementById('imageModal');
            if (imageModal.style.display !== 'block') return;

            if (e.key === 'ArrowLeft') {
                navigateImage(-1);
            } else if (e.key === 'ArrowRight') {
                navigateImage(1);
            } else if (e.key === 'Escape') {
                closeImageModal();
            }
        });
    </script>
</body>

</html>